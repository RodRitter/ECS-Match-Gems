{"version":3,"sources":["webpack:///webpack/bootstrap 6544178974e80cb1d321","webpack:///./src/core/system.js","webpack:///./src/core/component.js","webpack:///./src/core/entity.js","webpack:///./src/entry.js","webpack:///./src/core/game.js","webpack:///./src/systems/renderer.js","webpack:///./src/systems/gridSystem.js","webpack:///./src/systems/gameSystem.js","webpack:///./src/components/position.js","webpack:///./src/components/gridPosition.js","webpack:///./src/components/sprite.js","webpack:///./src/components/gravity.js","webpack:///./src/components/grid.js","webpack:///./src/components/gem.js","webpack:///./src/systems/positionSystem.js","webpack:///./src/systems/gravitySystem.js","webpack:///./src/systems/matchSystem.js"],"names":["System","constructor","game","id","name","onAwake","onStart","listen","callback","listenerObj","listener","listeners","undefined","Array","push","sendSignal","i","length","params","getComponents","components","componentArr","Object","keys","key","getComponentsWithDependency","dependencyName","allComponents","filteredComponents","component","dependency","entity","getComponent","filtered","getSystem","systems","system","Component","data","init","addComponent","getSiblingComponent","Entity","_generateRandomID","Date","toString","Math","random","addComponents","forEach","remove","window","entities","gameLoop","time","requestAnimationFrame","TWEEN","update","Game","running","start","_createSystems","addEntity","removeEntity","createEntity","Renderer","_init","sprites","_tick","bind","pixiRenderer","render","stage","renderNewSprites","PIXI","autoDetectRenderer","antialias","transparent","resolution","document","body","appendChild","view","setAttribute","Container","spriteComponents","spriteComponent","loaded","sprite","Sprite","fromImage","image","anchor","set","addChild","GridSystem","createListeners","grid","width","height","renderGrid","map","createMap","renderer","grids","posComponent","pos","x","y","w","h","circle","Graphics","lineStyle","drawCircle","scale","endFill","j","addExistingGemsToMap","gems","gem","console","warn","removeFromGrid","gridSys","spriteComp","removeChild","setPosition","from","to","getPositionFromGrid","getLowestEmptyGrid","check","GEMS","type","GameSystem","score","create","startSequence","fillEntireGrid","addTopRow","createRandomGem","setTimeout","randomIndex","floor","matches","log","Position","GridPosition","onClick","Gravity","Grid","Gem","PositionSystem","renderPositions","alignPositionsToGrid","gridSystem","newPos","GravitySystem","applyGravity","sort","compA","compB","calculateAndAnimateGravity","gemComp","lowGrid","currGrid","newGrid","animating","coords","target","randomDuration","posComp","animateGravity","positionComponent","duration","positionSystem","Tween","easing","Easing","Bounce","Out","onUpdate","MatchSystem","checkType","checkQueue","registerClickOnSprite","gemComponent","interactive","buttonMode","on","startMatch","origin","match","Set","onMatched","g","isQueued","newAlpha","alpha","Linear","None","onComplete"],"mappings":"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","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 6544178974e80cb1d321","export class System {\n    constructor(game) {\n        this.id = this.constructor.name;\n        this.game = game;\n    }\n\n    onAwake() {\n        // Implemented in system\n    }\n\n    onStart() {\n        // Implemented in system\n    }\n\n    // --------------------------------------------\n    // Simplified signal/messaging between Systems\n    // --------------------------------------------\n    listen(id, callback) {\n        let listenerObj = {listener: this, callback: callback};\n        if(this.game.listeners[id] === undefined) {\n            this.game.listeners[id] = new Array();\n        }\n        this.game.listeners[id].push(listenerObj);\n    }\n\n    sendSignal(id) {\n        let listeners = this.game.listeners[id];\n        if(listeners !== undefined) {\n            for (let i = 0; i < listeners.length; i++) {\n                listeners[i].callback();\n            }\n        }\n    }\n\n    sendSignal(id, params) {\n        let listeners = this.game.listeners[id];\n        if(listeners !== undefined) {\n            for (let i = 0; i < listeners.length; i++) {\n                listeners[i].callback(params);\n            }\n        }\n    }\n    // --------------------------------------------\n\n    getComponents(id) {\n        let components = this.game.components[id];\n        let componentArr = [];\n\n        if(components !== undefined) {\n            for (let i = 0; i < Object.keys(components).length; i++) {\n                const key = Object.keys(components)[i];\n                componentArr.push(components[key]);\n            }\n        }\n        \n        return componentArr;\n    }\n\n    getComponentsWithDependency(id, dependencyName) {\n        let allComponents = this.getComponents(id);\n        let filteredComponents = [];\n        \n        for (let i = 0; i < allComponents.length; i++) {\n            const component = allComponents[i];\n            const dependency = component.entity.getComponent(dependencyName);\n            if(dependency !== undefined) {\n                let filtered = {};\n                filtered[id] = component;\n                filtered[dependencyName] = dependency;\n                filteredComponents.push(filtered);\n            };\n        }\n\n        return filteredComponents;\n    }\n\n    getSystem(id) {\n        for (let i = 0; i < this.game.systems.length; i++) {\n            const system = this.game.systems[i];\n            if(system.id == id) return system;\n        }\n    }\n\n}\n\n\n// WEBPACK FOOTER //\n// ./src/core/system.js","export class Component {\n    constructor(game, data) {\n        this.id = this.constructor.name;\n        this.game = game;\n        this.init(data);\n    }\n\n    // Called when Entity adds the component\n    addComponent() {\n        if(this.game.components[this.id] === undefined) {\n            this.game.components[this.id] = {};\n        }\n        this.game.components[this.id][this.entity.id] = this;\n    }\n\n    getSiblingComponent(id) {\n        let components = this.entity.components;\n        \n        for (let i = 0; i < Object.keys(components).length; i++) {\n            const component = components[Object.keys(components)[i]];\n            if(component.id == id) return component;\n        }\n    }\n\n    init(data) {\n        // implemented in component\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/core/component.js","export class Entity {\n    constructor() {\n        this.id = this._generateRandomID();\n        this.components = {};\n    }\n\n    _generateRandomID() {\n        return `Entity_${(+new Date()).toString(16) + (Math.random() * 100000000 | 0).toString(16)}`;\n    }\n\n    getComponent(id) {\n        return this.components[id]\n    }\n\n    addComponents(components) {\n        components.forEach(component => {\n            component.entity = this;\n            this.components[component.id] = component;\n            this.components[component.id].addComponent();\n        });\n    }\n\n    remove() {\n        // Delete components first\n        for(var key in this.components) {\n            delete window.game.components[key][this.id];\n        }\n\n        // then delete entity\n        delete window.game.entities[this.id];\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/core/entity.js","import { Game } from './core/game';\n\nwindow.game = new Game;\n\n// Start Game Loop\ngameLoop(0);\n\nfunction gameLoop(time) {\n    requestAnimationFrame(gameLoop);\n    TWEEN.update(time);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/entry.js","// Core\nimport { Entity } from './entity';\nimport { System } from './system';\n\n// Systems\nimport { Renderer } from '../systems/renderer';\nimport { GridSystem } from '../systems/gridSystem';\nimport { GameSystem } from '../systems/gameSystem';\nimport { PositionSystem } from '../systems/positionSystem';\nimport { GravitySystem } from '../systems/gravitySystem';\nimport { MatchSystem } from '../systems/matchSystem';\n\n\nexport class Game {\n    constructor(){\n        this.running = false;\n        this.entities = {};\n        this.systems = [];\n        this.components = {};\n        this.listeners = {};\n        this.start();\n    }\n    _createSystems() {\n        this.systems = [\n            new GameSystem(this),\n            new Renderer(this),\n            new GridSystem(this),\n            new PositionSystem(this),\n            new GravitySystem(this),\n            new MatchSystem(this)\n        ];\n    }\n\n    start() {\n        // First create systems\n        this._createSystems();\n\n        // Awake systems in order\n        for (let i = 0; i < this.systems.length; i++) {\n            this.systems[i].onAwake();\n        }\n\n        // Game is now running!\n        this.running = true;\n\n        // Start systems in order\n        for (let i = 0; i < this.systems.length; i++) {\n            this.systems[i].onStart();\n        }\n    }\n\n    addEntity(entity) {\n        this.entities[entity.id] = entity;\n    }\n\n    removeEntity(entity) {\n        delete this.entities[entity.id];\n    }\n\n    createEntity(components) {\n        // Create Entity\n        let entity = new Entity(); \n        \n        // Add Components to Entity\n        entity.addComponents(components);\n\n        // Add Entity to Game\n        this.addEntity(entity);\n\n        return entity;\n    }\n\n    \n}\n\n\n// WEBPACK FOOTER //\n// ./src/core/game.js","import { System } from '../core/system';\n\nexport class Renderer extends System {\n    onAwake() {\n        this._init();\n        this.sprites = [];\n    }\n\n    _tick(time) {\n        requestAnimationFrame(this._tick.bind(this));\n        this.pixiRenderer.render(this.stage);\n        this.renderNewSprites();\n        TWEEN.update(time);\n    }\n\n    _init() {\n        //Create the renderer\n        this.pixiRenderer = PIXI.autoDetectRenderer(800, 600, {antialias: false, transparent: false, resolution: 1});\n\t\tdocument.body.appendChild(this.pixiRenderer.view);\n        this.pixiRenderer.view.setAttribute(\"id\", \"stage\");\n        //Create the stage\n        this.stage = new PIXI.Container();\n        this.pixiRenderer.render(this.stage);\n\n        // Begin render loop\n        this._tick(0);\n    }\n\n    renderNewSprites() {\n        let spriteComponents = this.game.components['Sprite'];\n\n        if(this.game.running && spriteComponents !== undefined) {\n            for (let i = 0; i < Object.keys(spriteComponents).length; i++) {\n                const spriteComponent = this.game.components['Sprite'][Object.keys(spriteComponents)[i]];\n                if(spriteComponent.loaded == false) {\n                    let sprite = PIXI.Sprite.fromImage(spriteComponent.image);\n                    sprite.anchor.set(0.5,0.5);\n                    spriteComponent.sprite = sprite;\n                    this.stage.addChild(sprite);\n                    spriteComponent.loaded = true;\n                    this.sendSignal('Renderer.SpriteLoaded', spriteComponent);\n                }\n            }\n        }\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/systems/renderer.js","import { System } from '../core/system';\n\nexport class GridSystem extends System {\n\n    onAwake() {\n        this.createListeners();\n    }\n\n    onStart() {\n        let grid = this.getComponents('Grid')[0];\n        this.width = grid.width;\n        this.height = grid.height;\n    }\n\n    renderGrid() {\n        if(this.map === undefined) {this.map = this.createMap()};\n\n        let renderer = this.getSystem('Renderer');\n        let grids = this.getComponents('Grid');\n\n        for (let i = 0; i < grids.length; i++) {\n            let posComponent = grids[i].getSiblingComponent('Position');\n            let pos = {x: 0, y: 0}\n\n            if(posComponent !== undefined) {\n                pos.x = posComponent.x;\n                pos.y = posComponent.y;\n            }\n\n            for (let w = 0; w < grids[i].width; w++) {\n                for (let h = 0; h < grids[i].height; h++) {\n                    let circle = new PIXI.Graphics();\n                    circle.lineStyle(2, 0xFF00FF);\n                    circle.drawCircle(pos.x + (w * grids[i].scale), pos.y + (h * grids[i].scale),2);\n                    circle.endFill();\n                    renderer.stage.addChild(circle);\n                }    \n            }\n        }\n    }\n\n    createMap() {\n        let grid = this.getComponents('Grid')[0];\n        let width = grid.width;\n        let height = grid.height;\n\n        let map = new Array();\n        for (let i = 0; i < width; i++) {\n            map[i] = new Array();\n            for (let j = 0; j < height; j++) {\n                map[i][j] = undefined;\n            }  \n        }\n        return map;\n    }\n\n    addExistingGemsToMap() {\n        let gems = this.getComponents('Gem');\n        for (let i = 0; i < gems.length; i++) {\n            let gem = gems[i];\n            if(this.map[gem.x][gem.y] === undefined) {\n                this.map[gem.x][gem.y] = gem;\n            } else {\n                console.warn(`Error: Trying to add Gem to occupied space on grid map.`);\n            }\n            \n        }\n    }\n\n    removeFromGrid(x,y) {\n        let gridSys = this.getSystem('GridSystem')\n        let map = gridSys.map;\n        let grid = map[x][y];\n\n        if(grid !== undefined) {\n            let renderer = this.getSystem('Renderer');\n            let spriteComp = grid.getSiblingComponent('Sprite');\n            map[x][y] = undefined;\n\n            if(spriteComp !== undefined) {\n                renderer.stage.removeChild(spriteComp.sprite);\n            }\n            \n            grid.entity.remove();\n        }\n    }\n\n    setPosition(from, to) {\n        this.map[to.x][to.y] = this.map[from.x][from.y];\n        this.map[from.x][from.y] = undefined;\n    }\n\n    // Get a global position form grid co-ordinates\n    getPositionFromGrid(x,y) {\n        let grid = this.getComponents('Grid')[0];\n        if(grid !== undefined) {\n            let posComponent = grid.getSiblingComponent('Position');\n            return {\n                x: posComponent.x + (x * grid.scale),\n                y: posComponent.y + (y * grid.scale)\n            }\n        }\n    }\n    \n\n    getLowestEmptyGrid(x,y) {\n        let grid = this.getComponents('Grid')[0];\n        let check = y+1;\n        while(this.map[x][check] === undefined && check < grid.height) {\n            check++;\n        }\n        return check-1;\n    }\n\n    createListeners() {\n        this.listen('Grid.CreateGrid', () => {\n            this.renderGrid();\n        });\n\n        this.listen('Grid.AddGemsToMap', () => {\n            this.addExistingGemsToMap();\n        });\n    }\n    \n\n}\n\n\n// WEBPACK FOOTER //\n// ./src/systems/gridSystem.js","// Core\nimport { Entity } from '../core/entity';\nimport { Component } from '../core/component';\nimport { System } from '../core/system';\n\n// Components\nimport { Position } from '../components/position';\nimport { GridPosition } from '../components/gridPosition';\nimport { Sprite } from '../components/sprite';\nimport { Gravity } from '../components/gravity';\nimport { Grid } from '../components/grid';\nimport { Gem } from '../components/gem';\n\nconst GEMS = [\n    {\n        image: 'resources/gems/element_blue_square_glossy.png',\n        type: 'blue'\n    }, {\n        image: 'resources/gems/element_grey_square_glossy.png',\n        type: 'silver'\n    }, {\n        image: 'resources/gems/element_purple_cube_glossy.png',\n        type: 'purple'\n    }, {\n        image: 'resources/gems/element_yellow_square_glossy.png',\n        type: 'yellow'\n    }\n];\n\nexport class GameSystem extends System {\n\n    onAwake() {\n        this.score = 0;\n        this.createListeners();\n    }\n\n    onStart() {\n        this.create();\n    }\n\n    create() {\n\n        this.game.createEntity([\n            new Position(this.game, {x: 50, y: 50}),\n            new Grid(this.game, {width: 12, height: 10, scale: 40})\n        ]);\n        this.start();\n    }\n\n    start() {\n        this.sendSignal('Grid.CreateGrid');\n        this.sendSignal('Grid.AddGemsToMap');\n        this.sendSignal('Position.AlignAndPositionToGrid');\n        this.sendSignal('Gravity.ApplyGravity');\n\n        this.startSequence();\n    }\n\n    startSequence() {\n        this.fillEntireGrid();\n    }\n\n    addTopRow() {\n        let grid = this.getComponents('Grid')[0];\n        let map = this.getSystem('GridSystem').map;\n\n        for (let i = 0; i < grid.width; i++) {\n            const grid = map[i][0];\n            if(grid === undefined) {\n                this.createRandomGem(i,0);\n            }\n        }\n\n        \n        window.setTimeout(() => {\n            this.sendSignal('Grid.AddGemsToMap');\n            this.sendSignal('Position.AlignAndPositionToGrid');\n            this.sendSignal('Gravity.ApplyGravity');\n            this.sendSignal('Match.RegisterClickEvents');\n        }, 10);\n    }\n\n    fillEntireGrid() {\n        let grid = this.getComponents('Grid')[0];\n        let map = this.getSystem('GridSystem').map;\n\n        for (let w = 0; w < grid.width; w++) {\n            for (let h = 0; h < grid.height; h++) {\n                const grid = map[w][h];\n                if(grid === undefined) {\n                    this.createRandomGem(w,h);\n                }\n            }\n        }\n\n        window.setTimeout(() => {\n            this.sendSignal('Grid.AddGemsToMap');\n            this.sendSignal('Position.AlignAndPositionToGrid');\n            this.sendSignal('Match.RegisterClickEvents');\n        }, 10);\n        \n    }\n\n    createRandomGem(x, y) {\n        let grid = this.getComponents('Grid')[0];\n        let randomIndex = Math.floor(Math.random() * GEMS.length-1) + 1;\n        \n        this.game.createEntity([\n            new Position(this.game, {x: 0, y: 0}),\n            new Sprite(this.game, {image: GEMS[randomIndex].image}),\n            new Gem(this.game, {x: x, y: y, type: GEMS[randomIndex].type}),\n            new Gravity(this.game, {})\n        ]);\n    }\n\n    createListeners() {\n        this.listen('Game.AddScore', (matches) => {\n            let score = (matches + (matches*1)) * 10;\n            this.score += score;\n            console.log(`+${Math.floor(score)} (${Math.floor(this.score)})`);\n        });\n    }\n\n    \n    \n}\n\n\n// WEBPACK FOOTER //\n// ./src/systems/gameSystem.js","import { Component } from '../core/component';\n\nexport class Position extends Component {\n    init(data) {\n        this.x = data.x;\n        this.y = data.y;\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/components/position.js","import { Component } from '../core/component';\n\nexport class GridPosition extends Component {\n    init(data) {\n        this.x = data.x;\n        this.y = data.y;\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/components/gridPosition.js","import { Component } from '../core/component';\n\nexport class Sprite extends Component {\n    init(data) {\n        this.image = data.image;\n        this.sprite = undefined;\n        this.loaded = false;\n        this.onClick = false;\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/components/sprite.js","import { Component } from '../core/component';\n\nexport class Gravity extends Component {\n    init(data) {\n        \n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/components/gravity.js","import { Component } from '../core/component';\n\nexport class Grid extends Component {\n    init(data) {\n        this.width = data.width;\n        this.height = data.height;\n        this.scale = data.scale;\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/components/grid.js","import { Component } from '../core/component';\n\nexport class Gem extends Component {\n    init(data) {\n        this.x = data.x;\n        this.y = data.y;\n        this.type = data.type;\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/components/gem.js","import { System } from '../core/system';\n\nexport class PositionSystem extends System {\n\n    onAwake() {\n        this.createListeners();\n    }\n\n    renderPositions() {\n        let components = this.getComponentsWithDependency('Position', 'Sprite');\n        \n        for (let i = 0; i < components.length; i++) {\n            const posComponent = components[i].Position;\n\n            const spriteComponent = components[i].Sprite;\n            let sprite = spriteComponent.sprite;\n\n            if(sprite !== undefined) {\n                sprite.x = posComponent.x;\n                sprite.y = posComponent.y;\n            }\n        }\n    }\n\n    alignPositionsToGrid() {\n        let gridSystem = this.getSystem('GridSystem');\n        let components = this.getComponentsWithDependency('Position', 'Gem');\n\n        for (let i = 0; i < components.length; i++) {\n            let newPos = gridSystem.getPositionFromGrid(components[i].Gem.x, components[i].Gem.y);\n            components[i].Position.x = newPos.x;\n            components[i].Position.y = newPos.y;\n        }\n    }\n\n    createListeners() {\n        this.listen('Position.RenderPositions', () => {\n            this.renderPositions();\n        });\n\n        this.listen('Position.AlignToGrid', () => {\n            this.alignPositionsToGrid();\n        });\n\n        this.listen('Position.AlignAndPositionToGrid', () => {\n            this.alignPositionsToGrid();\n            this.renderPositions();\n        });\n    }\n\n\n}\n\n\n// WEBPACK FOOTER //\n// ./src/systems/positionSystem.js","import { System } from '../core/system';\n\nexport class GravitySystem extends System {\n\n    onAwake() {\n        this.createListeners();\n    }\n\n    applyGravity() {\n        let components = this.getComponentsWithDependency('Gravity', 'Gem');\n\n        // Start from lowest Y and work way up\n        components.sort(function(compA, compB) {\n            return compB.Gem.y - compA.Gem.y;\n        });\n        \n        for (let i = 0; i < components.length; i++) {\n            this.calculateAndAnimateGravity(components[i]);\n        }\n    }\n\n    calculateAndAnimateGravity(component) {\n        let gridSystem = this.getSystem('GridSystem');\n        let gemComp = component.Gem;\n\n        // Get lowest grid\n        let lowGrid = gridSystem.getLowestEmptyGrid(gemComp.x, gemComp.y);\n        \n        // set to lowest grid\n        let currGrid = {x: gemComp.x, y: gemComp.y};\n        let newGrid = {x: gemComp.x, y: lowGrid};\n\n\n        if(gridSystem.map[newGrid.x][lowGrid] === undefined) {\n            gemComp.y = newGrid.y;\n            gridSystem.setPosition(currGrid, newGrid);\n        \n            // Animate gravity\n            if(newGrid !== currGrid) {\n                this.animating = true;\n                let coords = gridSystem.getPositionFromGrid(currGrid.x, currGrid.y);\n                let target = gridSystem.getPositionFromGrid(newGrid.x, newGrid.y);\n                let randomDuration = 550;//Math.floor(Math.random() * (750 - 650)) + 650;\n                let posComp = gemComp.getSiblingComponent('Position');\n                this.animateGravity(posComp, coords, target, randomDuration);\n            }\n        }\n    }\n\n    animateGravity(positionComponent, coords, target, duration) {\n        let positionSystem = this.getSystem('PositionSystem');\n\n        new TWEEN.Tween(coords)\n        .to(target, duration)\n        .easing(TWEEN.Easing.Bounce.Out)\n        .onUpdate(function() {\n            positionComponent.x = coords.x;\n            positionComponent.y = coords.y;\n            positionSystem.renderPositions();\n        })\n        .start();\n        \n    }\n\n\n    createListeners() {\n        this.listen('Gravity.ApplyGravity', () => {\n            this.applyGravity();\n        });\n    }\n\n}\n\n\n// WEBPACK FOOTER //\n// ./src/systems/gravitySystem.js","import { System } from '../core/system';\n\nexport class MatchSystem extends System {\n\n    onAwake() {\n        this.checkType = undefined;\n        this.checkQueue = [];\n        this.createListeners();\n    }\n\n    registerClickOnSprite(spriteComponent, gemComponent) {\n        spriteComponent.sprite.interactive = true;\n        spriteComponent.sprite.buttonMode = true;\n        spriteComponent.sprite.on('click', () => {\n            this.startMatch(gemComponent.x, gemComponent.y);\n        });\n        spriteComponent.onClick = true;\n    }\n\n    createListeners() {\n        this.listen('Renderer.SpriteLoaded', (spriteComponent) => {\n            let gemComponent = spriteComponent.getSiblingComponent('Gem');\n            if(gemComponent !== undefined) {\n                this.registerClickOnSprite(spriteComponent, gemComponent);\n            }\n        });\n    }\n\n    startMatch(x,y) {\n        let gridSys = this.getSystem('GridSystem');\n        let map = gridSys.map;\n\n        let origin = map[x][y];\n        this.checkType = origin.type;\n        this.checkQueue.push(origin);\n\n        // check left\n        if(x-1 >= 0) {\n            this.match(map[x-1][y]);\n        }\n\n        // check right\n        if(x+1 < gridSys.width) {\n            this.match(map[x+1][y]);\n        }\n\n        // check top\n        if(y-1 >= 0) {\n            this.match(map[x][y-1]);\n        }\n\n        // check bottom\n        if(y+1 < gridSys.height) {\n            this.match(map[x][y+1]);\n        }\n\n        this.checkQueue = Array.from(new Set(this.checkQueue)); // Remove duplicates\n        this.onMatched(this.checkQueue);\n        \n    }\n\n    match(gem) {\n        if(gem !== undefined) {\n            let gridSys = this.getSystem('GridSystem')\n            let map = gridSys.map;\n\n            if(gem.type == this.checkType) {\n                this.checkQueue.push(gem);\n\n                // check left\n                if(gem.x-1 >= 0) {\n                    let g = map[gem.x-1][gem.y];\n                    if(g !== undefined && this.isQueued(g) == false) {\n                        if(g.type == this.checkType) {\n                            this.checkQueue.push(g);\n                            this.match(g);\n                        }\n                    }\n                }\n\n                // check right\n                if(gem.x+1 < gridSys.width) {\n                    let g = map[gem.x+1][gem.y];\n                    if(g !== undefined && this.isQueued(g) == false) {\n                        if(g.type == this.checkType) {\n                            this.checkQueue.push(g);\n                            this.match(g);\n                        }\n                    }\n                }\n\n                // check top\n                if(gem.y-1 >= 0) {\n                    let g = map[gem.x][gem.y-1];\n                    if(g !== undefined && this.isQueued(g) == false) {\n                        if(g.type == this.checkType) {\n                            this.checkQueue.push(g);\n                            this.match(g);\n                        }\n                    }\n                }\n\n                // check bottom\n                if(gem.y+1 < gridSys.height) {\n                    let g = map[gem.x][gem.y+1];\n                    if(g !== undefined && this.isQueued(g) == false) {\n                        if(g.type == this.checkType) {\n                            this.checkQueue.push(g);\n                            this.match(g);\n                        }\n                    }\n                }\n            }\n            \n            \n        }\n    }\n\n    isQueued(gem) {\n        if(gem === undefined) return false;\n        \n        for (let i = 0; i < this.checkQueue.length; i++) {\n            if(this.checkQueue[i].x == gem.x && this.checkQueue[i].y == gem.y) {\n                return true;\n            }\n        }\n        return false;\n    }\n\n    onMatched(matches) {\n        let gridSys = this.getSystem('GridSystem');\n        \n        if(matches.length >= 3) {\n            for (let i = 0; i < matches.length; i++) {\n                const gem = matches[i];\n                let sprite = gem.getSiblingComponent('Sprite').sprite;\n                \n                let newAlpha = {alpha: sprite.alpha};\n                let target = {alpha: 0};\n\n                new TWEEN.Tween(newAlpha)\n                .to(target, 100)\n                .easing(TWEEN.Easing.Linear.None)\n                .onUpdate(function() {\n                    sprite.alpha = newAlpha.alpha;\n                })\n                .onComplete(() => {\n                    gridSys.removeFromGrid(gem.x, gem.y);\n                    this.sendSignal('Gravity.ApplyGravity');\n                })\n                .start();\n                \n            }\n            this.sendSignal('Game.AddScore', matches.length);\n        }\n\n        // Reset\n        this.checkType = undefined;\n        this.checkQueue = new Array();\n    }\n    \n\n    \n\n}\n\n\n// WEBPACK FOOTER //\n// ./src/systems/matchSystem.js"],"sourceRoot":""}